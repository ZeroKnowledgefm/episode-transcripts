Anna Rose (00:00:05):
Welcome to zero knowledge. I'm your host, Anna Rose. In this podcast, we will be exploring the latest in zero knowledge research and the decentralized web, as well as new paradigms that promise to change the way we interact and transact online.

Anna Rose (00:00:26):
This week, Guillermo Angeris and Alex Evans returned to the show to chat about the research that they along with Tarun had been putting out over the last year. We explore the methodology behind their work on CFMMs AMMs and related primitives. We also dive into some of the recent findings and what they're looking forward to working on in the future. Before we kick off, I also want to remind you about the ZK Hack online event. ZK Hack consists of weekly workshops about key ZK tools and an advanced puzzle competition. There's a fantastic community forming around this event. So do jump in. I've added the link to the site in the show notes. You can sign up there and find out more about the program. Hope to see you there. Also, if you're looking to get into the ZK space professionally, we are hosting a ZK Jobs Fair happening on December 2nd, as part of the overall ZK hack event, the ZK Jobs Fair, we'll be featuring some of the top hiring teams in ZK.

Anna Rose (00:01:18):
This gives you the chance to meet them in a more casual setting as you're applying. So you may want to check it out. You can also check out the ZK jobs board, where you can find ads from these teams looking to hire. The links for all of these can be found in the show notes. Today's episode is sponsored by Aztec. Aztec aims to be the privacy layer for Ethereum. They believe that unlocking programmable privacy is the next frontier for blockchains. Aztec is the first zero knowledge roll-up built from the ground up for anonymous payments and DeFi transactions. If you want to protect your payments, you should join the thousands of users already sending funds privately on ZK money, that zk.money we've added the link in the show notes. So thank you again, Aztec for sponsoring this episode. Now here's my conversation with Tarun, Guillermo and Alex. So today I'm talking with Guillermo, Alex and our, sometimes co-host Tarun. Tarun I think for this episode, you're going to be a little bit more like a guest, because what we're going to be talking about is the work that the three of you have been doing over the last, I don't know, year or two. So yeah, I want to welcome back Guillermo and Alex to the show. Welcome guys.

Alex (00:02:29):
Thank you. It's awesome. Being back.

Guillermo (00:02:30):
Thanks for having us.

Anna Rose (00:02:32):
So both of you have been on the show before, but I know a lot of kind of happened since those episodes, Alex, you were on, I think almost two years ago. I'd love to hear what you've been up to in that time.

Alex (00:02:44):
Oh, my life has taken a turn for the worse. So I've now come to a place where we're writing one paper a month with these two, mainly as punishment. But also as entertainment.

Anna Rose (00:02:58):
What about you Guillermo? You were on the show actually earlier this year. What have you been up to since then?

Guillermo (00:03:00):
Yeah, so for the most part, well, I mean, as with these two, I've just been writing a bunch of weird sick and twisted papers, but I've technically come to the conclusion that at some point I should finish my PhD and, and one of my two professors also come to a similar conclusion, although the other one has yet to be convinced. So hopefully by March I'll be, you know, defending and presenting the whole deadly due to physics that, you know, almost nobody, I guess, from the show probably has ever heard of for the better, in fact I would say, okay, but that's, that's the plan at least so far fingers crossed.

Anna Rose (00:03:35):
Very cool. Let's talk a little bit about the research you've been doing. And maybe before we jump into the specifics, what is this research for? Why are you producing one piece of research every month and who's paying attention to it?

Guillermo (00:03:48):
That's a question for Tarun, actually.

Tarun (00:03:51):
Yeah, so, I mean, I think we started working on kind of research in this vein realistically in like 2019. And part of the thing that I guess I had seen and it took me a while to convince Guillermo, but I think he eventually believed me was that there was kind of this thing that was happening in DeFi that really resembled kind of the early days of, of AI pre-image net, like basically like 2008 to 2011 where a lot of the like important research was actually done outside of academia. And not only was it done outside of academia, a lot of like the kind of rigorous stuff. The theory was also sort of started outside of academia, not just like the, like, Hey, we ran a bunch of experiments and we could predict X thing at 99.8% instead of 99.5, which is like 90% of machine learning papers nowadays.

Tarun (00:04:49):
And I think like there was this, there's a thing where like, there's all this stuff happening and there are all these very counter-intuitive things going on, where there is something like Uniswap, which, you know, to someone from finance and certainly like SPF Sam from FTX and, and CMS and all, all these trader people were always on Uniswap on Twitter. And part of the thing that more careful observers who are looking at the on-chain data kind of noticed with that, there was actually quite a crazy amount of usage and people weren't losing as much money as one might naively think. And I think that just led us down the rabbit hole of like, Hey, this stuff that looks kind of like on the surface, like it shouldn't work or it's stupid in some way, actually, since we were working in practice. So there must be some more fundamental reason for, for why that is. And around that same time I met Alex randomly and he was like also doing the same thing. He kind of believed sort of the same thing. He'd been like writing these probably the only formal ish paper on MakerDAO at that time. And so this is like early 2019.

Alex (00:05:57):
No that's right, I run into Tarun at his office. They would host the number of events there and I'd heard of him from actually another guest on the show ---- who had mentioned him as somebody who really knew his leap on mathematics. And as some of the listeners who have seen Tarun might know he does stick out in a crowd. So I approached him with that research and it turns out he was working on very similar things at the time. I think he was doing some credit risk analysis for compound, which was somewhat analogous using actually much more efficient and useful techniques than the ones I was using. Hence the emphasis on the ish and then with automated market makers turns out we were asking very similar questions. In fact, I had written a whole paper that Guillermo and Tarun had sort of answered the same question that I was going after and one appendix and two paragraphs, which is a common theme in our work. We'll get into that soon of me writing very, very long and complicated things to which Guillermo will respond with a paragraph replicating the result in a simpler way. But that's sort of the origin is I think we were working on very similar things around the same time and couldn't beat them. So I joined them.

Anna Rose (00:07:00):
Nice. Okay. So you're starting, you're starting point is like sort of the CFMM and AMMs and exploring these, I guess when you talk about like Uniswap being, I guess one of the first dApps you were really looking into, like, why does this thing work? What are the properties, but do you feel like, has that expanded from AMMs or do you, do you still see that as like the core focus of most of your work?

Guillermo (00:07:24):
So at the end of the day you know, CFMMs are like AMMS very generally are like one very particularly nice class of things to study. And, you know, as one can imagine the problem with research papers that you always end up with more questions than you actually answer. In fact, this is, this is almost universally true, and if it's not true, then you haven't written a research paper. It's like, you know, you wrote something, you wrote an essay instead of any research paper. So in some sense, I guess kind of like kind of stepping back and going pretty a layer higher, right. To the meta it's that we've, we've kind of realized that, you know, there there's a bunch of products that people want to replicate on chain, a bunch of financial products that all have these interesting properties, like options and all of these things. And, you know, most people kind of come at it from a very traditional finance angle. And that's simply because of the fact that, you know, that's what people are trained in and this there's like, you know, these like simple notions that we all like know and love about options. For example, this is a very specific example, but CFMMs give you kind of a weird perspective on how to actually do things on chain and in some sense they're are like a very natural, let's call it a primitive, you know, a DeFi primitive, if we may, that lets you do a bunch of things that don't seem intuitively obvious how to do on chain, but give you a very natural framework to think about. So, you know, in, in the previous case, when in such cases options, right, that's, it seems kind of weird and you have to do these complicated mechanisms that require Oracles and all these things, but the case of CFMMs actually gives you kind of a natural way of constructing roughly the same object without the use of Oracles. So CFMMs are of, you know, the way we think about it is you have this class like this very large set of items that you can do on chain and CFMMs are a particular set of items. That's very surprisingly large. It's a very large class. I mean, it's kind of actually shocking and research highlights just how shocking it is, how large that set is. Even though it looks like a very specific instance, right. But then you can do, you know things you can do on chain without using Oracles. I don't know if that kind of made sense, but the point is like, it's this very natural framework for which to think about what are the things that we can replicate without using Oracles on chain. It's not the set of all things you cannot believe without using oracles, but it's just, it's a large class. And our, our point is, you know, there's some boundaries around this like set of items. One can replicate and the, our research kind of pokes at the boundaries repeatedly of like, how much is it? You know, how much can we actually subsume within this umbrella of constant function, market makers or whatever.

Anna Rose (00:09:50):
So are you finding though things that don't work in them as well? Like are there some examples that you could already like say these, we tried, this won't work we're going to have to rely on Oracles.

Alex (00:10:01):
Very simple example will be just in the example of Guillermo just mentioned, we have a paper or one of our more recent papers, and this is now two papers ago, Replicating monotonic payoffs without Oracles describes a class of, for instance, payoffs that users may desire that are fairly popular, for instance, regular call options and so forth that have unbounded upside and are convex. And we can get into what that means, but you can't do that just simply without an Oracle, you need either full collateralization, which is very inefficient or you require an Oracle in order to do that. It turns out actually that things that don't require Oracles. And this is maybe the big thesis or idea of a lot of this work. It turns out to be quite broad. So you can do short of that, almost anything if for instance, you clip the payoff at some upper bound, you'll be able to do that without an Oracle and maybe even taking a step back. Why is this a useful exercise to begin with? And that is that Oracles are perhaps the main source of both financial and technical complexity in DeFi and turns out that they expand the surface of vulnerabilities quite significantly for on chain financial contracts. So if you look, a lot of the exploits that have happening Guillermo has a recent thread on this, a lot of them are related Oracles. And so it's in fact, a useful exercise. It's not just theoretically which, you know, is our primary motivation to be candid, but also practically in terms of how do we design systems, you know, the exercise of how do we minimize use of Oracles and how far, how much damage can we do without them is I think to us, something practitioners in DeFi beyond should be asked.

Anna Rose (00:11:39):
When you mentioned that, like the fact that there's an Oracle could lead to exploits, is it mostly like arbitrage opportunities or like when you say exploit here, I want to understand a little bit more what you mean.

Tarun (00:11:53):
I mean, there's a bunch of different types of ways that this can happen. I mean, I think the, the simplest ones are where you have another product that does a non-reversible transaction. So when I say a non-reversible transaction, I mean, something like a liquidation where once the transaction is through, there's not really a way to like put back that capital indirectly, right? So like a trade in an AMM, if you're willing to take the fee is reversible and that I can trade back and forth and get it back to the same initial price. But there are a whole notion of transaction that are irreversible in finance. And that's usually when it's something like a liquidation or some type of settlement, final settlement, and whenever those occur, and those are dependent on an Oracle price on some notion of price of the assets, such that it triggers such an event, then it can at times become much more valuable to manipulate the price calculation rather than try to like enter into that financial product. And so manipulating the price calculation can either be done by manipulating the Oracle directly or manipulating sort of the inputs to the Oracle. So the recent Cream attack and the almost Aave attack are effectively Oracle manipulation attacks, where in a flash loan, you manipulate an Oracle, cause a liquidation and then sort of take the other side with that indirectly. I mean, it, it's a lot more complicated for those assets, but the assets that were used in both of those, but, you know, Oracles are certainly a source of vulnerabilities. And I think one of the reasons the Uniswap stood out to us in 2019 was really this fact that somehow in spite of there being no Oracle, it was able to effectively induce market participants to make it a good Oracle where there's enough, arbitragers trading against it. That the cost of manipulation is extremely expensive. Whereas protocols that try to be explicit Oracles like Uma, none of them had a couple other properties. One is they had to artificially create this notion of the cost of corruptibility was expensive, right? You either do it by having a token, forced me to stake..., But you don't really give them financial upside in an asset. They might already value like ETH. Whereas the Uniswap people were earning ETH and stablecoins. And that was like one big difference between that and sort of the other Oracle systems. The other thing is that other Oracle systems act more like legal courts than they do like blockchains because they, they rely on all sorts of like challenge games. And like, you know, you could view the UMA Oracle is not that different than an optimistic roll-up in some ways. And I don't mean that necessarily positively in Ethereum, like in other blockchains, it's actually great for a bunch of reasons, but in Ethereum, the way that doing these kinds of like post event resolutions is just extremely, extremely annoying. And I think in like other blockchains, some of the more complicated designs are actually going to be more user-friendly because I think people just don't like having this A. when people submit a transaction to Ethereum, they want to say, okay, I submitted it. It's confirmed. I never have to think about it again. Right. The problem with Oracles that have sort of post trade settlement is that you submit the transaction, you see it got confirmed in the block, but then you also have to keep watching the blockchain for another 10 blocks before you decide, okay, it's actually in and for better or worse, this is an industry of degens. So it's not like they're actually really going to want to do that, right? This is no knock against the UMA design. I think it's just that doesn't work as well on Ethereum. I think it's actually not a bad design somewhere else.

Alex (00:15:34):
It turns out that our work explains in some ways where that design is, or some version of that design is necessary. And then it turns out that these problems can be avoided for certain financial applications. It's just that some applications, in fact, very many applications don't need that sort of complexity at all. So one way to think about it, just to make it really clear is the types of guarantees that you have in Oracle dependent systems are of the form. Either property X holds. In other words, I don't get liquidated unless the price falls below a certain amount or the Oracle has failed, which in the case of UMA falls down to there, the cost of corruption versus the profit from corruption and some equation holding between those two. And that requires that sort of security assumption to hold in order for your property, whatever desirable property or your system to hold and in the work on CFMMs as well as related systems, the assumption is either property X holds.

Alex (00:16:33):
In other words, in this state of the world, this user gets the same pay off as this option or some other property holes such as the portfolio is 50 50 balanced between two assets or whatever else. Or somebody has a very significant arbitrage opportunity that they've left on the table and haven't exploited which is a much stronger assumption to make, right? Which is there's pre money somewhere. And somebody is going to pick it up. And if they haven't, then I can't make any guarantees about my system, but if they have, here's what I can say about what the user will get or whatever other property I'm interested in. Yeah.

Guillermo (00:17:08):
Maybe, maybe the tweet long summary goes something like CFMMs and our admittedly biased opinion are a particularly natural way of thinking of financial instruments or replicating financial instruments on the blockchain without Oracles. They might not be the space of all things, but they are a very surprisingly large section of it,

Tarun (00:17:30):
Right, not zero. You know, I think like the SBFs and people like that, you know, who ran exchanges, centralized exchanges, one of the reasons they couldn't kind of believe this was true is everyone thought the space of such things was zero. Like it was empty. Like there were no such applications, right? Uniswap was the first thing that proved that, Hey there, the set's not empty. But then since then, basically you could think of what we're doing is trying to like find the largest surface convex hole in some bad joke manner of like the set of all of these mechanisms.

Anna Rose (00:18:03):
What I still want to understand though, is like, who is this research for? Are protocols asking you like, Hey, can you look at my CFMM? Can you look at my model?

Tarun (00:18:13):
It started more out of like pure intellectual curiosity. I'll also like, I, you know, I guess my company was certainly like, we use these types of things within how we simulate stuff, but it also started from like, Hey, there's actually something bigger here. And over time, the more we started writing these papers, the more random people on the internet would like message and be like, Hey, I'm like building this thing based on your paper. Or like, Hey, I'm going to do this other thing based on your paper. And over time, it became much more clear that by going this route, we were sort of actually opening up the space for other people who like didn't, who maybe were not so mathematically sophisticated, but were your usual DeFi developer, like 19 year old, like lives in Asia, somewhere kid. And they, this was like kind of a way for them to kind of find new things to do. And then when MEV happened, it became much more clear why people really liked our papers because no one else knew how to write the formula for what the arbitrage optimal arbitrage was. And so the flashbots discord is filled with lots of random anons passing our papers back and forth.

Anna Rose (00:19:21):
This actually speaks to something. This is this idea. And I'm, I mean, I think we're starting to notice this more and more where researchers, academics or, or not are putting research out into the world. And sometimes there's like these groups that are forming around this research and those are becoming in a way that the next generation of projects it's, it's very much not the way I've understood this kind of progress in the past, like working more inside, potentially in labs or what have you still kind of keeping it a little bit to yourself until it's ready here. It's like, as it's being built, there's teams forming around some of these ideas. I think flashbots, as an example, we had them on the show a while back. And I just think the idea of forming this like research group just around open public research, it's, it's so organic and I think it's really powerful. It's not something you guys could push though. Can you, you can't predict like, or have you been able to like find teams to build out any of these ideas or test them out?

Tarun (00:20:21):
Yes. The answer to that is definitely.

Anna Rose (00:20:22):
Okay. You have.

Tarun (00:20:24):
I think, I think, I think the bigger thing is like, it wasn't clear when we started this, that that would be the direction things would go. I think when they started it, it was, all of us were just like, how does this make sense? But also does, like, there should be some, like, there was just this inkling or feeling that, Hey, look, you know, in the 1970s sort of when options pricing theory first was developed, the options market was basically non-existent. It only existed in legal contracts. And people were basically like when they had options that were like employee stock options or warrants, like they were not like traded options on equity. But the idea that there existed a model to price things is actually what caused plus electronic markets is what really caused the options market to boom. Once people had sort of a lingua franca to use for deciding like what it meant to hold X amount of risk, people were able to use, you know, use these as risk. More of course, things blow up model doesn't work all the time. Yada yada, yada, whatever that's. I mean, that's, those are, those are the devil is left to like the user. But the point is that there's clearly with some new theory here. And, you know, we were just more convinced that it was like this like intellectually curious thing. And all the people in cryptocurrency land are really always focused on these like distributed systems or cryptography guarantees, but they like kind of always leave it as a quote exercise to the reader, all of the economic or crypto economic things. I mean, just look at the Chainlink paper, for instance, right. It doesn't really specify what it's, the true economics are no knock to them, but they probably still have to figure that out soon. But I think that the main point is that, you know, there's clearly some new type of way of thinking about quant finance here that due to the idea that settlement is sort of instant amongst other things. And I think that that was where it started was that kind of curiosity, which probably was true for a lot of people in the bear market who are looking at the stuff because there were only 10 of us. Yeah.

Alex (00:22:24):
Yeah. We all know each other now. And we all DM each other constantly and try the nerd snipe each other. So at this point it's like a weird click of random people.

Anna Rose (00:22:32):
Okay. But tell me, tell me more about the builders that you are finding. Like, are you actually sourcing these things? Are you saying like, I just published this paper, we need a group. Like, how do you even do that?

Alex (00:22:42):
So people come out of the woodwork, I mean, and like on Twitter and so forth. And we will know their names very often. And you'll find that people can go very deep and understand very concretely how things work sometimes not so much to be counted, but very often we have, these ideas are mostly theoretical. You see the papers are mostly like Guillermo's PhD advisor, who I recently met calls street fighting mathematics, and just essentially, you know, little cute things that we do. And here's this thing like it or not, here's how it works. And there's a lot of work that needs to go from, to take that from a theoretical idea to actual code and something that's implementable in practice. And so these people will ask all the right questions about how this thing will work and all that one team, for instance, that's working on the replicating market makers paper, which Guillermo in very high-level terms rehearsed earlier, essentially went through that exercise and are currently going through that exercise of taking sort of a fairly abstract academic idea and it into an implementable project that users can actually interact with and get the types of guarantees that at least in theory are possible. And that obviously requires a lot of engineering work or requires a lot of security work and it may be some of the mathematical properties help you there. But of course what they look like in a scary, horrible twisted world of the EVM and and solidity is very different. And so we don't claim these are, these teams is work. And you know, we can, we've been helpful to the extent that we can, but of course, you know, these are brilliant engineers, developers and so forth that are really sort of pulling the weight here.

Tarun (00:24:24):
To be fair. Also, this is also true with ZKPs and consensus protocols, right? Where like the original paper is a very far cry away from like what the actual implemented thing looks like. Right. But it gives you sort of a north star, but it's a very lossy north star. And as you try to like chase the rainbow metaphorically, well thats a bad metaphor, but as you try to kind of follow this guide, you realize, Hey, I'm getting finer and finer resolution and like, oh, I missed this thing or I missed this other thing. I missed this other thing. And you kind of only learned that stuff from actually trying to build these things or, you know, write code that does what they're supposed to do. And I think that's sort of the, the next step from this type of stuff. But it's, it's almost the same in my mind is like the people who are writing the early ZKP papers where it was more this like curiosity as to like, can you actually get succinctness? Can you actually get non interactivity? Can you actually like, get these random polynomials to like, not be in a field whose order is more than the number of particles in the universe, dot, dot, dot dot. Right. And these things always start with the kernel of that. Like all of the AI and machine learning stuff that people do started with this kernel of like, actually I believe like just throw more hardware and like increase the size of this stuff. And don't care about like, proving the formal math. I'm much Guillermo chagrin because he's around more of the shills in Stanford. Unfortunately.

Anna Rose (00:25:55):
It's interesting because it's almost like, I mean, especially looking back at some of that early work, it does sometimes feel like through the curiosity solutions are offered, but the problems haven't been defined yet. Like you can, you can kind of figure out like, what is the problem we're trying to solve with this, but it's like, there's so many interesting properties in this solution that you're looking to see if it fits other problems afterwards. I don't know if I, I dunno if it's like that at all in the work you're doing.

Tarun (00:26:21):
I think for DeFi it's a lot, one thing I would say is different is like a lot of times our papers are fast follow to like, Hey, someone did something in practice that they have no justification for. And there's no reason it should work, but we kind of started trying to write out the math and then all of a sudden it's like, okay, ah, there's clearly some reasons for working. Here's the reason it's resembles more of like the relationship between physics and maths, right? Where like physics find something that completely is non-sequitur to mathematician. And then mathematicians spent 50 years and try to like create the theory for it. Try to create the, you know, like, oh, we have to invent some new type of math to do it. Here it's a much more pedestrian. It's more like there's gotta be something that's working. The space of things is that it could be, is quite small because blockchains kind of restrict the actual execution and state and everything of, of the system. There's not that there's only certain types of users, et cetera, but, you know, I don't, I think some of our papers are predictive. Some are sort of retrospective, but in some, some ways I think one thing that's been very clear is that people who are like economists and applied math people and people from machine learning, people who like kind of hate crypto, normally they read our papers on like them because they write them in a language that they understand.

Alex (00:27:37):
That's an optimistic version of it. There's also another type of paper, which is perhaps our most popular, certainly to that group. Also, typically our most simple, which is just us being the really annoying, stupid people at the back of a room. And somebody coming to us with a solution or the most recent example is this paper we wrote on liveness failures on blockchain. So actually our most qualitative paper, the ones we've written and it came out of

Tarun (00:28:05):
It's really an, a slightly better than a blog post.

Alex (00:28:09):
Yeah. I think that's one way to say it.

Guillermo (00:28:11):
And I think that the, the technical term is called an academic shit post is what I believe is the technical term it's written in tech, but that's about all you can say.

Alex (00:28:19):
But essentially the premise of that, and maybe this is a good segue into that, that work here briefly. So we can, we can touch on it is we're just getting a lot of DMs and talking to really smart people that are building things let's say on non-ETH chains that are a little faster and cheaper to build on. And very often we'll hear this pitch of like, Hey, here's this thing that works on Ethereum, call it a lending protocol, call it an options protocol. And we'll just rip out the CFMM and add an order book and we're going to have a much better system. And so doing. And so this paper is saying more like, whoa, not, not so fast, not, not, not saying that that's a bad idea, but here's some trade-offs potentially to consider. And in particular, one of the things we point out is sometimes we have liveness failures on blockchains and that was no more acute than in Solana. And so this kind of bleeds into Tarun's point of, you know, we just noticed an event and we're like, well, what happened here? What are some underlying dynamics to consider? And in this case, we noticed that in order to align the prices of CFMMs with an external market after liveness failure, you only need to do one really big transaction and computationally that one transaction is just as complex and expensive as a smaller transaction, as opposed to on an order book where if the price moves against you in a really big way or a Uniswap V3, the price moves against you in a big way. You have to cross multiple ticks and that's much more expensive to execute, or you need to clear significantly more orders in order to walk the book to the new price. And so once the blockchain regains liveness that requires users to submit much more expensive transactions at a period where everybody's rushing, for instance, to clear their liquidations, to execute certain transactions from safekeeping. And that creates an environment where you're much more vulnerable, for instance, to very significant price moves that negatively affect your returns as a liquidity provider to these AMM. So certainly we like the capital efficiency and we like the flexibility of these types of designs and are excited to see them proliferate in places where transaction costs are cheaper. But fundamentally what we're saying in this paper is that there are trade-offs to that. And those trade-offs need to be considered in the design of these protocols.

Anna Rose (00:30:35):
Interesting. And that paper you're talking about, it's like liveness on Solana. You're looking at like, what is the effect of liveness where I guess if liveness goes down, is that what you say? If liveness disappears? What happens to these? I guess you're looking at the two different systems, right? Like order book and CFMM and comparing. Yes. Effectively to me, it was, it's kind of like an awesome case study you got to examine, or could you predict it like, or did you need this to happen to say like, oh, this is going to happen.

Tarun (00:31:04):
Let's put this way. All the math in the paper for the most part, I mean, minus a couple little like technical nuances was already stuff we'd written a long time ago. In fact, we have this one paper that basically is like the God paper and has like all of this stuff. But I feel like no one has actually ever read it because everyone who's giving. Yeah. I feel like every single thing I've work on now, just like somehow I'm referencing that paper all the time. But basically like it became sort of clear that it's not like the math was new as much as it was like, what's the actual story for like what this thing that happened was using the existing framework.

Alex (00:31:47):
The stories are typically ones Tarun and Tubers, which is also descriptive of his role because we jokingly call him our PI and sometimes the math will all be there, but there's no story around it. And we're doing, it's our fearless leader in that.

Guillermo (00:32:02):
Yeah. And we're like Tarun, please fill in, you know, Tarun auto-complete whatever the, whatever the GitHub code AI thing is. That's Tarun for us in stories. You just like...

Tarun (00:32:13):
Copilot.

Guillermo (00:32:13):
Yeah. There you go. It's the co-pilot so it's a, we have, Tarun copilot AI where here we messaged a telegram group. And then you know, he turned goes and fills in all of these like nice little gaps and be like, oh, this beautiful story about how it all works. It's like, oh my God, you're totally right. You know, I almost convinced myself that I that's exactly what the paper was about at the end of the day...

Anna Rose (00:32:33):
Can you share some other examples of that? Like what other kind of storytelling type papers have you done?

Guillermo (00:32:39):
So, so like as Tarun said, there's the, there's the top paper. Or as I like to call it the goldmine or the gift that keeps on giving, and it's this weird paper that, she has a hilarious title. It's kind of silly, but it's called a, when does the tail wag the dog? And it's, I think it's called curvature and market-making as the subtitle or something like that. That's the, that was the first, the OG storytelling paper. It's like, we realize that at a certain point, you know, what became the most liquid exchange for a bunch of random tokens? It wasn't Coinbase. It certainly wasn't NFTX. No, it was like Uniswap V2. And so Tarun and Alex had been talking about this and it was this, you know, at the beginning it was a little bit of a complicated story because we were like, oh, we have all these things that we want to show and all of this, like how what's the largest trade you can make in order to like incur, you know, or after which LPs start losing money. Right. And things like that. These, these kinds of like things that we all knew and, or like at least had some idea that if you make, you know, if a trader trades like really large trades against you, you kind of end up losing money and all of these things. So that was the original storytelling paper where I think the original paper started at what did it start at guys? I remember it's like 8 pages or 10 pages. And then I think if I recall correctly, the last posting on archive was about 45.

Anna Rose (00:33:56):
Wow. Big story.

Guillermo (00:33:57):
Yeah. True. Truly big story. But it's kind of fun because it turns out that paper predicted a bunch of weird results that we ended up writing, but that was the original one where we, you know, tell a story about, oh, look, you know, why do you need yield farm? Like why did yield farming become so interesting and useful? And it's like, well, it's because, you know, LPs, we're used to kind of losing money if they weren't careful about things exploding, but it's like yield farming kind of helps you out with that. And so it has this effect and it has all of these like qualitative, but mathematical, but you can write them down effects downstream for LPs and for traders and so on and so forth. I was kind of the paper that outlined using very basic math, exactly how these things came into play. And then it told you things like, okay, how much do you have to incentivize a pool in order to keep LPs happy and all of these things. And but that was the OG story paper, I think. And it's, it's still the gift that keeps on giving.

Tarun (00:34:50):
The meta narrative is like, you know, when we started, it was like, okay, everything was on centralized exchanges, but there was this kind of niche thing that was somehow growing. And the initial idea was like, okay, well clearly the centralized exchanges are like way better for the users. So like the secondary exchanges must be for people who really need them. And so most of the arbitrage must be coming from people who see the price on centralized exchange being different than the price on the DeFi exchange and decentralized exchanges almost as if it's like an Oracle, it's like the perfect price, but the DeFi exchanges, this kind of like shitty price, but people who have no other way of getting the asset have to go there. And so we started with this model of like, oh, like, how do these things work? Assuming there exists some sort of infinitely liquid, external market. And then as the market progressed, it just became more and more natural to say, Hey, look, wait, these markets are growing faster than Coinbase and NFTX like Coinbase and NFTX, three volumes are flat-lining and Uniswaps and sushi swaps and stuff are mooning. There must now be some other market structure thing that happened. And our initial paper kind of doesn't capture that. Right. It only captures the case when it's sort of the secondary or shittier market, but when it's the main one, then there's this kind of this question of like, oh, well what happens when these DeFi things are actually like dominating the centralized thing? And that's a very different question and you have to come up with a new way of framing it, but the math is not very hard. In fact, Guillermo usually just yells at Alex and I, anytime we try to do any math that like, like undergrad first year, like couldn't, you know, barely can take a derivative, like type of student could use like a sort of philosophy of his advisor of like keep it simple, extremely simple, stupid. And any of them were complicated math.

Alex (00:36:41):
He's seen some things to be fair to him. Seven pages of differential equations that I sent him and I got a virtual slap in the face and grabbed me by the shoulders and shook me. And we do for the listener of spam Guillermo and enough to the point where he's, he's become quite annoyed. I think it is a typical approach, right? Like, we'll see something like what Tarun is describing. But it was just, look, it looks like these CFMMs are willing the centralized exchanges to pay their price, as opposed to the other way around, or we're seeing all these people design these private in air-quotes CFMMs do they work or do they not. And very often the first order approximation is just brute forcing an answer to the question that this type of phenomenon poses and it is typically very ugly. And I think the approach that hopefully works over the long-term is to simplify it as much as possible to the point where it's accessible to a wider audience and Guillermo in our group is kind of tasked with doing that as annoying as it is.

Tarun (00:37:54):
To be fair. I think that is sort of the part of the reason that I think people from other disciplines are able to read this stuff. I think one of the problems I often times had when I was an outside person and was reading like cryptography research, like both zero knowledge, proof stuff, and proof of stake stuff is it's like almost written in a purposely like, you reader. You're too dumb nave. Like don't read, don't read like, and like the, the way these papers are written is like obscuring. Often at times I feel like is over complicated to obscure that it's like actually a simple result. Totally. Or like extremely long, like, you know, something that like in math would be like a one-line to express. Someone wants to write it as an algorithm. And it's like, now you, you have to do the reverse engineering as the reader to try to like understand, oh, they really just spent like, use this concentration in a quality instead of like run this algorithm with randomly on random input. So, you know, somehow I think coming from outside of the space also for all three of us made us not necessarily like the writing style often found.

Anna Rose (00:39:03):
I want to ask a little bit more about the storytelling though, the MEV paper that you did. Like, are you there? You're kind of going outside of some of, I mean, I think you're going a little bit outside of the CFMM and maybe, maybe not actually, but is that a storytelling one or is that prescriptive? And maybe you can talk a little bit about that work.

Guillermo (00:39:23):
Yeah. Yeah. So, so the MEV paper essentially let's yeah. So let's talk about, the MEV paper. So they MEV paper essentially says like, look, miners, get a bunch of, of bundles, which the bundles themselves or something tell you something like, look, I want my transaction placed before and after, you know, another transaction, like some whale trade on Uniswap is called a sandwich, or I want my transaction place right before it or whatever. And the question of course the miners have is, okay, I have this huge thing of this number of bundles. How do I optimally accept bundles such that A- They don't interfere with each other because that's kind of silly. And B very importantly, is how do I - how to do that in order to maximize my profit? Right? So right now people were coming up with all kinds of complicated heuristics and all this kind of stuff. It turns out there's a very, very simple kind of framework to think about these problems called a mixed integer. I guess it's linear programming in this case, right? Where essentially you have a bunch of constraints and you're saying, okay, subject to these constraints, which is you can, you can't have a sandwich transaction and also something coming after it that requires it be made immediately. It's essentially, you can't have these bundles interacting too much and be that like, you know, the, the bundles will actually fit in the places that they're supposed to be placed. So those are your constraints. Then you, you want to maximize what, well, you want to maximize your total profit from including these bundles as, as a miner, but this kind of, you know, maybe slipping back from that, that's a, that's what one might call a somewhat story-telling paper in the sense of like, you know, all of this is a note and it's five pages long and it's really not that complicated. So why are we making it that complicated, but kind of stepping back from that, this is what Alex, and I guess my, my advisor Stephen Boyd called street fighting mathematics, it's this notion that at the end of the day, all of these problems are actually fairly straightforward. You know, it look, it does take a lot of thought to get them down to this like very simple looking shape. And, and in fact, we've gotten knocked for it a few times by reviewers, which I continue to completely ignore and just continue with myself. But the point is, you know, there, there's a set of pretty common mathematics that doesn't require that much sophistication. And you have these problems that look very complicated at the surface, but you, and, you know, they of are complicated if you think of all the details and everything at the same time, but the point of, you know, math and computer science and all the stuff is, is abstracting a very, very clean, simple solution from these problems. And sure it requires a little bit of math, but at the end of the day, it's actually shockingly simple. And so the, our rabbit hole has been CFMMs simply because it's kind of been an interesting thing of ours, but I guess maybe probably by the end of the year, we'll probably be stepping back and leaving you know, people with a set of open questions and kind of moving on to these more adjacent fields, because CFMMs, sure, fine, they're interesting. And they're great. And they're like, whatever, you know, we've done all this research about them, but at the end of the day, they're yet another tool in the toolbox to do things that we want to do. And that's kind of the purpose of our research is not so much the, you know, the point of here are CFMMs, here is all the cool things about them. Like, yeah, that's fine. And that's, that's a great consequence, but it's not the point, right? The point is to do useful things. And that happened to be a useful case. It's now kind of, I think personally reaching the end of its life in terms of like, truly novel, interesting solutions, but there are many, many more fields like it.

Anna Rose (00:42:42):
I mean, actually you were on the show previously to look like we were talking mostly about private AMMs and are they possible and what are techniques to do that, are you also looking though at these intersections? So you're saying like, oh, there's these other problems, faces MEV is a very well known one, but are you ever thinking about like, what do they actually do to each other? I mean, privacy, and AMMs there, you see it, like, that was part of the work, but yeah. Are you also doing that with MEV or maybe some other things?

Tarun (00:43:10):
One thing to say about the liveness paper and the differential privacy paper, basically show that in order to get certain properties or avoid certain bad scenarios, you actually do have to reason about how the consensus protocol interacts with the application. So in the liveness case, it really boils down to like your choice of mechanism for liquidity provision is actually implicitly reliant on some sort of bound on the maximum time the network goes down and the maximum price deviation, you might not think about that when you're designing the application, you're just like, I'm writing an order book. How do I, how do I have a FIFO queue? How do I do this type of order? How do I do an iceberg order?

Anna Rose (00:43:51):
Cause you're not expecting the network to go down..

Tarun (00:43:54):
Exactly. Right. Or in the privacy case, you're like, oh, great. I'm going to hide the balances. I'm going to hide the balances. So no one can figure everything out. And then you're, you're not thinking of the threat model of, well, okay. What if the person who's actually trying to de-anonymize you is also a validator, also a miner, right. And in some sense, a lot of our more recent work, I think personally, the paper I'm most proud of from our thing is definitely the differential privacy thing. But that's just my, just because it kind of exemplifies this fact that like, you can't really design these things without thinking about consensus at some point, like there are just certain properties that will eventually be that. And for Uniswap, it did get kind of lucky that it took so long for MEV to happen. Right. Like if there was so much MEV on at the beginning when Uniswap started, I, I think it would have actually been much harder to bootstrap or like people to understand how to use the mechanism without getting blown out of the water.

Anna Rose (00:44:54):
One thing maybe to note though, the paper you've just referenced the differential, privacy is not the work we talked about with Guillermo. So there was an evolution there, right? Like, or was the first one that you did much more like, here's why people's approaches are wrong. So a bit of story, and here's a few ideas. Maybe you can talk a little bit about that journey and that like evolution of your thinking into this more, I guess, more specked out solution of differential, privacy.

Guillermo (00:45:23):
Yeah. Kind of a, a one, two punch. And it was actually not intentionally a one, two punch, but the point was the original paper that we talked about, I think, yeah. March of this year essentially said, look, here's the deal. You can't just willy nilly hide things from the user and from anyone snooping around and then expect that in fact, that actually confers you privacy when you have, you know, when you're, when you're interacting with a CFMM. And, and it was kind of a simple result. It was pretty short, this notion that a lot of people had intuitively, but it specked out exactly how the attack would play out. And then we just kind of gave a few simple paragraph stating, look here, here are some cases where the proof fails. One is okay. If you batch up a bunch of transactions together, then people can't tell them apart. Then congratulations, that's one. Number two is you know, if you add kind of noise to the prize. So if you, if you present the user with a price that isn't actually exactly quite the price of the CFMM, then it's a little harder for them to reconstruct up to some, up to a certain degree, the more noise, of course, the worse it could be for LPs or the user, but the harder it is for them to infer the, the underlying prices and therefore the harder is for them to infer what trades have happened. And so that was the first one and it kind of said, look, the approaches here, it's not obvious. Right. The problem, isn't an obvious one. It isn't just simply add a ZKP to Uniswap and be done with it. Yeah. Right. And then we were left with this horrible, sick and twisted edge of being like, okay, this is great. We've just told you that you can't do this, but can you actually do this in some way? That makes sense. Right. And this is, this is you know, Tarun answer was the, was the differential privacy paper.

Tarun (00:47:04):
Yeah. So around the time that we wrote this paper, actually, Anna and I were both in Austin at that time.

Anna Rose (00:47:11):
During the snow storm.

Tarun (00:47:13):
This was right after the snow storm actually. And like we put out that paper and I had basically by happenstance, kind of been like a little annoyed that we didn't find some like simple trick, like one like a Buzzfeed article way of getting around the impossibility theorem, like one easy trick that makes this wrong. But I happened to run into this paper by pure happenstance, by like Nika Haghtalab and Roughgarden and someone else that kind of introduced me to this whole new world of things that like people were working on in terms of like privacy versus utility trade-off. So like, there's this kind of this idea for any learning algorithm. And so we can make the Uniwap. You could think of the Uniswap price algorithm as a learning algorithm. It's learning like in a very dumb sense. It's not, it's not like a very sophisticated learning algorithm, but it's, it is something that's sort of like learning how to update the price as a function of the reserve. There's this kind of natural trade-off in machine learning that people in cryptography and in cryptocurrency don't think of a lot, which is this utility versus privacy trade-off. If I add in a bunch of noise to blind your data, will I also make any function of your data of worse? So like, if I randomize your height, well maybe I preserve the mean height over everyone, but I kind of mess up the variance of the height or I mess up other statistics of the height if I had like a table of people's heights. And in some sense, there's always this trade-off you, you effectively can't get out of it. And going down that line of research just kind of led me through like how people in sort of machine learning, think about this stuff, which then I found over time, over many months of agony, a way to adapt it to this setting.

Anna Rose (00:49:10):
Interesting. Just one side question, like why in machine learning, do you use these techniques? Like, what are they for?

Tarun (00:49:18):
So like the best example is the US census. So the US census collects a lot of data, right? And there's tons of sociology researchers and like people who do that type of stuff historically have relied on the census at for data. But then people have shown these kinds of attacks where people can de-anonymize people's individual census items based on the average that is produced. So like, let's say someone gives you the average of like the height of a certain area. And it happened to be an area where someone lives that was seven foot tall. You could effectively infer if their data was in the dataset or removed. And, and so in some sense, like the

Anna Rose (00:49:59):
Exceptions, the unusual ones.

Tarun (00:50:00):
Yes. And those are the people who oftentimes value their privacy the most. So there's kind of this weird thing where that happened. Then the US census was like, okay, we're going to use these privacy techniques. And now sociologists are all because they didn't know how to be fair. All their, all they learned how to do is import our library, call our library on census data. But, you know, so I don't think they really checked carefully, like the math they were doing and like how sensitive it was to noise. But the point is there's a lot of times where someone can take a dataset and augment it with external data, a data set that's anonymized, and then de-anonymize it. So there's this famous example in New York where Uber had to provide a New York city with all the Uber trips. But there were anonymized and then someone found another dataset related to, to like Uber coupons or something. And then they joined it and they were able to de-anonymize because the one was de-anonymize, one was anonymized. And so then they found all these and this, this actually, I forgot if it was the Elliot Spitzer thing or if it was like some other like sex scandal, but they did find this like politician who was like constantly going this one strip club. And that was like a,

Guillermo (00:51:13):
The other famous example, which is actually really, it's kind of what started kind of kicked off this whole field was a Netflix in 2008, had a very famous Kaggle challenge that a very famous challenge was. Can you predict what movies people are gonna like, you know, given their previous, like, you know, ratings or something like that. And this, this, this that was completely public, right. And it a big dataset and some researchers went through and essentially what they did was they just using mind you, like, this is ridiculous, right? Like just using people's preferences for movies, they were able to de-anonymize I can't remember the exact number, but it's like either a quarter or a half or something of all people watching. This is, again, mind you, Netflix movies in '08. Right? Like, think about that. And that's they were able to de-anonymize something like half of them or a quarter of the dataset, just from their movie preferences and running with some other datasets. So it's, it's, you know, we, we joke that it's some esoteric mathematical thing, but at the end of the day, actually, it's, it, it turns out to be hilariously simple and you can run it on a laptop and do some real damage.

Anna Rose (00:52:16):
But where? The differential privacy, like where was that first thought of, or implemented within a machine learning context, if you remember, like, was it that census one? I mean, I think you've, you've given great examples of that.

Tarun (00:52:29):
I actually think it's Apple. Cause they were like the biggest proponents an iPhone. So a lot of the data you send to apple servers is encoded in a differentially private manner. I don't know about which things are and aren't, I haven't actually read their docs carefully enough, but they were the first like big tech company to invest a lot into it. Their whole like claims of being really good about privacy or about this. But of course they have other things that are not so good. So let's not try to make lionize anyone, but, but the point is that basically when things started moving to the cloud in 2006 I think Apple was the first one to be like, no, no, no. We're only putting stuff in AWS servers if it's differentially private, because AWS. Right? It actually, ironically wasn't about protecting a user. It was about protecting someone else from taking the data of your user and that wasn't you

Anna Rose (00:53:18):
And using it.

Tarun (00:53:21):
But, but the idea here is that this utility versus privacy trade-off is like, say I have a machine learning algorithm that takes your ratings, right? Like, like what Guillermo said and it perfectly, it can perfectly predict your ratings, but it leaks information about you versus something where I add noise. And now I ruined the prediction, quality its prediction goes from being perfect to like 75% accurate, but your privacy has gone up. Right? So that's sort of, that's the thing you should be thinking in your head like that. That's why the Netflix example might be the cleanest one.

Anna Rose (00:53:51):
Now let's hear then how is differential privacy actually used in our context?

Tarun (00:53:57):
So, so imagine you have someone who has a machine learning algorithm where they can try to predict where the whale order is. So let's say there's a, there's like a thousand trades of size one. So it's like one Guille coin for one Alex coin. And then there's the whale Guillermo. Who's like, I want to akin to Alex, I'm going to bank a thousand. I'm going to trade a thousand Guille coins for sorry, Alex. For Alex too. Don't worry. I trust me, that sounded a lot worse than once I said. And so, so the idea is like the people who have this very small trade size, the one coin size, they all want to actually be in front of the person who is the 1000 trade size. Because like the, once the person who trades the size of a thousand trades, they will push the price up a lot. Right. And, and all the people who are like the small, small fries will get kind of way worse price impact. But from the whale's perspective you actually are like, Hey, I just want it to be fairly priced. I don't care where I get put, I just want it to be like fair. Right? And so the whale is the one who's trading their privacy. Right. In some ways, because like they just stick out like a sore thumb, their trade size is way bigger than everyone else's. So statistically people can try to say like, oh, I know this is the whale's order. I'm going to front run them. And this

Anna Rose (00:55:19):
Exception we were talking about before, I guess this is the exception result. That's very, very visible.

Tarun (00:55:25):
Yeah. Right. And in trading that's much more common, right? Like when there's like a, a liquidation, there's just like a million MEV bots and searchers trying to chase it. Right. So, and they're all have small size relative to the thing that's getting liquidated. So this type of scenario is extremely common and finance even more so than in the sociological data type of scenario. And so the idea is like, privacy, well, what does privacy mean to the whale? Well, it means that somehow they can still get the same amount of quantity, the thousand orders, but it's going to get intersperse. So imagine if now I cut up the trade of size thousand into a hundred pieces of size 10, and then I randomly intersperse them amongst the other trades of size one. Do they get a better price? And how, how easy is it for someone to front run every single one of their size 10 orders and right. And so, because I'm adding some entropy by cutting up the orders and splitting them, that's increasing my privacy, but I'm re I'm making my price worse than some sense because I'm splitting up my trades and I might have had more, you know, it could be worse. And so that's sort of the trade-off that we kind of analyze and show that you can, if consensus can provide a, a source of randomness for doing this kind of chopping up and permuting action, then you can achieve kind of this, these types of privacy guarantees.

Anna Rose (00:56:45):
When you talk about cutting them up though, are you cut it? Like, would it be cut up in equal sizes? Or is this also somehow like random?

Tarun (00:56:52):
No, that's a good point. That's a very nuanced detail that Guillermo asked me about five times when I, because it was like, which is no no, you actually do sample from an unknown distribution, a way to cut up the pieces. So like not only is the, like the randomness, not only does it randomly cut up the pieces into different sizes, but it also does it in such a way that the distribution over how it cuts them up is not known. That's the key, that's the very key, crucial part. Otherwise you're kind of, if someone knows the distribution, they could simulate it and try to say like, oh, this is the most likely cutting,

Anna Rose (00:57:29):
But how would you keep that private? Like how would that not be known when you're talking like open source? Like, isn't it kind of there?

Tarun (00:57:37):
Provided you have an input source of randomness that is, that you trust like a VDF or a VRF you can sample from this distribution of how to cut things up in a differentially private manner itself. Right? So this, all, everything, the, the route security detail will end up being like, does your VRF or VDF actually give you enough entropy. I got it. So that's why consensus is important to this, right? It's an application that takes advantage of the randomness guarantees of consensus. But this is another situation where the application layer has to interact with the actual blockchain.

Anna Rose (00:58:12):
So, I mean, the example you gave was focused on the whale and this exceptional amount, but are you actually imagining this running on all amounts, even if they aren't exceptional?

Guillermo (00:58:25):
So the idea is that that would be, well, A. there's kind of trade-off for the user, right? For the whale. For most

Anna Rose (00:58:32):
When I say exceptional, I mean, outlier.

Guillermo (00:58:34):
Yeah, yeah, exactly. Right. So for, for most users that it, the trade-off is the following it's zero because they're just going to trade anyways. Right. the trade off is either there's kind of two, there's one of the exceptional user level. And there's one at the base layer level of, you know, actually the, the CFMM itself is going to have some sort of price that back that's different, but at the wheel level, it's, you know, you have a slider that says, how much privacy do I want, versus how much do I care that this thing just gets executed? And it doesn't cost me personally. So there is a cost in some sense, the point that Tarun is making is that there's a cost of privacy, right? And, and, and, and it's, it's a cost of a very literal sense of at the end of the day, you were paying for that, whether you want to or not, right, you can, you can choose to not pay for it, but now you've traded off your entire privacy. So the

Anna Rose (00:59:19):
Which could impact your actual trade.

Guillermo (00:59:21):
Exactly. Exactly. So it's, it's, you either eat up the cost of the trade or you eat up the cost of privacy and, and take your pick, right. There's a slider there and that's fine, but, but at the end of the day, there's not really an obvious way of making them together. And then certainly there isn't one obvious and immediate succession because of the paper that we were previously talking about at the end of the day, you, you, you can't have your cake and eat it too.

Anna Rose (00:59:41):
This is interesting. So it isn't blanket differential, privacy across the board, but more of an optional differential, privacy. Are there, and I imagine you've explored this, but are there any other edges or leaks that could come out of this that are not covered by the differential privacy slider?

Guillermo (00:59:59):
So there are some one, one case that we've made previously, which is kind of interesting and also requires kind of control of the consensus layer, although you could implement it later is one thing that would actually just immediately improve privacy is just simply matching orders off chain. So you can imagine that there is some sort of, you know, there's a bid on a contract header that if, if that bid is one, what it does is it immediately start some algorithms. So, so when the block has minted, part of consensus requires you match orders prior to including them in the CFMM. Right? So the idea is like, look Alice and Bob trade in opposite directions. And then there's like, whale, I dunno, Willy, whatever who trades in, like, you know, some, some other direction, the point is you match everyone's orders off chain, right? And then it's kind of, if no one can see the, the amounts and privacy is some reserved in some sense, right. In the CFMM itself. And then Willy just uses the remaining part of the, you know, whatever's leftover to trade against the CFMM. And then of course, you know, here's the deal Willy loses privacy, right. But everyone else is pretty much safe. Got it.

Alex (01:01:03):
Assuming you obviously lost the aggregator. So there's some off-chain operator that is collecting these trades and matching the offset. And there's some secure way of communicating with them, which I would love to see it if somebody has it, but it doesn't suit them.

Guillermo (01:01:16):
Exactly. So the, at the end of the day, it's all trade offs, right? There's not an obvious, like it's not a bomb proof box, but it does seem to be at least a somewhat watertight. Maybe it's the, that's the statement.

Anna Rose (01:01:30):
So that paper came out, I don't know, two months ago, or so have you seen anyone try to do it or play with it actually like implementing it?

Tarun (01:01:41):
Osmosis. They're the ones who are going to actually, going to, Osmosis and Penumbra there, they're both going to actually try to implement it.

Anna Rose (01:01:47):
Amazing.

Alex (01:01:49):
I mean, just as we said earlier, these are mostly theoretical ideas and taking them to practice in particular, this one is going to require some really talented people, Osmosis and Henry from Penumbra, these, these folks from brilliant. And so if somebody is going to do what they're going to do it, but it certainly is not all there in fact, very far from it. These are just high level ideas with horrible constants and so forth. They give you a big idea of a set of trade-offs that one should consider, but it doesn't tell you what types of parameters we should select or how you should actually implement these types of systems in production.

Anna Rose (01:02:23):
It also sounds like in that implementation, I mean, I'd be so curious to see if they find, you know, new problem spaces or maybe new solutions to through that.

Tarun (01:02:33):
Yeah, for sure. I mean, one of the things Henry seemed most excited about this was like, he was like, I don't care about the constants. Snarks still have the worst constants. If you read the papers carefully, like a lot of the original snark papers have just like horrendous, like hidden, exponential constance, and like over time people in practice, like I would say like Ariel and Zac's research program, at least for me as an outsider, if I were to describe this uptake, it's like, literally just remove it, reducing every single constant that is in the, all the original stark papers to something practical.

Anna Rose (01:03:07):
You mean plunk, like what they've done with plunk.

Tarun (01:03:09):
Yeah. All the entire, series, like you look up FF plonk, all these things are like, if you read them carefully are just like constant reduction method mechanisms, which is the type of thing that you do when you're like actually doing engineering and not like armchair math in some way.

Guillermo (01:03:27):
Yeah. But when you, when you're what I like to call doing real people, things as opposed to like fictional made up world fantasy that we do run writing papers, like, like 90%. I mean, 10% of it is actually useful, but at the end of the day, it's you know, storytelling as we like to call it.

Anna Rose (01:03:42):
Well, I am so excited to hear that people are now experimenting with this it's yeah. It's, it's awesome to hear this. So I think to wrap up this episode, what I would like to hear from each of you is actually a space or topic, something that you haven't yet explored where you see your research potentially going towards, so Alex, why don't we start with you?

Alex (01:04:03):
The honest answer here is that, and you know, the answer you know, cause we've been chatting about it is that we've been looking a lot at ZK and we're so early in that exploration where the directions are less clear, we're really interested in ZK more generally, right. But some areas where we can be useful and our work can potentially be constructive out the gate or more in application areas, as well as some of the things Tarun describe in terms of acceleration of certain things and maybe some more practical examples of how these things can be used. The economics of ZK systems is very little work sort of on, you know, there's not all these roll-ups, there's now all these private layer ones, right? What are the different types of economic arrangements between the agents in these networks? And those are areas where we can maybe do damage out the gate, but then we're certain there's much deeper and more sophisticated problems that we'll encounter as we pursue that exploration as there were in CFMMs and MEV and staking and lending protocols that we discovered in that work. But the reality is we're very early in that exploration.

Anna Rose (01:05:11):
Cool. All right. Tarun, what about you?

Tarun (01:05:15):
Two main things to your point about there being a lot of cart before the horse? I kind of think like a lot of the cryptography ZK stuff is a little cart before the horse and that's not necessarily bad, but you know, we're going to have all of these private networks with smart contracts soon TM and you know, like the Aleo transitions, all that, all these sorts of people. But I, I guess I think that there's not really any applications that exist to be honest, other than transfers, like, yes, we want private smart contracts. We want private smart contracts, but we don't really have that many applications. And as kind of our CFMM thing shows, there's kind of this thing where you need to figure out how to design applications, where you partition the private part from the public part. And you're able to like cleanly abstractly, separate the two of those. And then, then consider the set of applications, financial applications. You can build conditional on there being a clean separation between public and private data. And I think that is sort of the, the realm of things that I want to really understand more carefully. And then of course, MEV, you know, I think one thing about MEV is it's like a great meme, but I do think like in general, the research has been quite muddled partially due to marketing, partially due to like other things. You know, I think like fair sequencing as a thing is very half-baked in a lot of ways. And doesn't is, doesn't like kind of reveal all of its warts to the average end-user. At the same time, I also think MEV is like not been theoretically described. You know, I think there's been some work like Phil has a recent paper that kind of tries to get at things, but everything is very brute force. Like it's like use formal verification or do something. And there's no actual like mathematical theory that has any sort of aesthetic beauty that has shown up. Everything's very ugly or like extremely like, you know, like it doesn't really like get to the, the like meat of the system, which is like, Hey, we introduced this type of behavior. The economic equilibrium changes amongst the agents and the new equilibrium has all of these different properties that are like very different from the fully honest, non rational user case. Right. Somehow we don't have a story like that. We only have this thing of like, Hey, I can like do this kind of, not very easy to explain mathematically thing. And like, maybe we find that you can make a profit. Well, that's not like a much of a story, right. That, that doesn't really actually tell you, like what's going on amongst all participants. And so getting to something like that, that's like less brute force, I think, unless like less computer science focused, because I think like the, no offense, the computer science parts of MEV are kind of boring in a lot of ways. They like really don't illustrate like the reason that people are having these like big shooting wars. You know, when I say shooting word, I mean like data center wars, and like co-locating next to certain miners doing X, Y or Z, right? Like all people don't do that stuff just because of like a computer science reason alone. Right. There has to be some sort of like, it's like finance, like why do you build a microwave towers? Well, there's like a certain equilibrium that occurs once they actually exist. You change the equilibrium. Right. And in some sense, like that's what's happening. And yet people want to just focus on kind of like the kind of boring details to me, boring, at least like there's no aesthetics to it. And like people should have some sense of aesthetics when they write papers. And I mean, I don't know whether Guillermo's laughing at me or

Guillermo (01:08:53):
Yeah. I think, you know, that Tarun lost the the, the phrase aesthetics, because I, I have this, this weird joke that I like to say and there's, and, and I apologize because this might offended in fact, some of my colleagues, but there, there are three fields in, in ranked order that have probably the worst aesthetics I've seen and they're in exactly the following order and it is physicists, and, and I can say this because I'm a physicist, this one I can say without offending people. And it's because if you go read it, you know, most physics papers absolutely illogical, even if you're like in the field. And often what ends up happening is you go and re-derive everyone's results, then right immediately after is economists some actually, there's, there's some cases, very special cases where they have good aesthetics but almost universally completely logical. And, and furthermore, they often depend on parameters that like you can't even measure. So they say something like, oh, the number of, or the proportion of informered vs. uninformed traders. And it's like, okay, good luck measuring without looking at you know market data. And, and you can even come up with models and all this crap at the end of the day, it's like, whatever. And, and number three, and these are kind of the most penetrable. And I apologize, it's computer scientists, absolutely theoretical computer scientists. Some, some algorithms papers are okay, but for the most part, almost universally, illegible. And, and, and, and the reason why is, and, you know, this kind of feeds into why, why I think our work is interesting is at the end of the day, right? Like there's kind of one kernel of important distilled knowledge that comes from a paper. And like, you should write a paper thinking very explicitly about this. And it's hard. It's really hard because it means you end up rewriting your paper a bunch of times, and it's, you know, you end up reworking a bunch of the, of all of these things that, you know, at the end of the day, you're like, yeah, of course that's obvious it's immediate from like, you know, this long 50 paragraph description of the algorithm. Right. Kind of what we were talking about previously. But I think the, the point of our research now is we like to find good and clean obstructions that explain things simply. And of course, you know, we landed in this interesting case, which was CFMMs, but there are, there are so many more problems that have, you know, in some sense have this heuristic that if a human can Intuit the behavior of a system and that system, it's probably simple enough that you can describe it simply as well. And so I think the kind of taking the meta level here as we kind of go forward, the point is finding these, these pockets of things that people care about and things to people find interesting and describing them using, you know, very simple language. And at the end of the day, it's almost universally very simple. Like if you can work out some calculation for it, why the hell is it not simple? You know, you don't need a sat solver to describe, you know, X or Y or Z. You can just write down a three paragraph definition from which like all of these results follow. Again, we, we landed in CFMMs as being a particularly one such abstraction, but at the end of the day, there's millions of these things that people are kind of hinting on. We're all slowly but surely like churning through. But no one's really sat down and, and it's hard work, right? No, one's really sat down and put in the hours to be like, all of these results are in fact, just consequences of X, right. X here could be, it could be many things, you know, it could be some framework for finding out how protocols interact with MEV in a simple way that is clear. It could be the same case with privacy. You know, what can you say? What what must private protocols have in order for those things to even be, you know, real and all of these things. So I guess that's, that's kind of where, where we landed and, you know, this is the thread of all of our work at the end of the day, but we're looking forward to, you know, moving past, I guess, maybe like what I guess this, this trio is now known for, which is CFMMs into broader spaces that are, you know, hopefully at least as if not more interesting as you know, this area we've been exploring for the past two years.

Anna Rose (01:12:46):
Very cool. All right. I want to say, thank you so much for walking us through all of this research kind of landing on where you're going. I'm so excited to see what comes next. So thanks.

Alex (01:12:58):
Thanks

Guillermo (01:12:59):
Thank you for having us.

Anna Rose (01:13:00):
And I want to say thank you to the podcast producer, Tanya, the podcast editor Henrik, and to our listeners. Thanks for listening.

